local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Window
local Window = Rayfield:CreateWindow({
    Name = "ARK",
    Icon = 10180536602,
    LoadingTitle = "ARK",
    LoadingSubtitle = "By zxkuhl",
    Theme = "Default",
    ToggleUIKeybind = "K",
    ConfigurationSaving = { Enabled = true, FolderName = "ARK_AC", FileName = "ARK_HUB" },
    Discord = { Enabled = true, Invite = "KPUPp4m9pJ", RememberJoins = true },
    KeySystem = true,
    KeySettings = {
        Title = "KEY",
        Subtitle = "Enter key",
        Note = "Get key in Discord",
        FileName = "KEY_FILE",
        SaveKey = true,
        GrabKeyFromSite = false,
        Key = {"Jcheeks130"}
    }
})

-- Services
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local MarketplaceService = game:GetService("MarketplaceService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

----------------------------------------------------
---------------------- MAIN TAB --------------------
----------------------------------------------------
local MainTab = Window:CreateTab("MAIN", 10180536602)
local MainSection = MainTab:CreateSection("MAIN FEATURES")

MainTab:CreateButton({
    Name = "Infinite Yield",
    SectionParent = MainSection,
    Callback = function()
        pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()
        end)
    end
})

MainTab:CreateButton({
    Name = "Fly",
    SectionParent = MainSection,
    Callback = function()
        pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/XNEOFF/FlyGuiV3/main/FlyGuiV3.txt"))()
        end)
    end
})

MainTab:CreateButton({
    Name = "Dark Dex",
    SectionParent = MainSection,
    Callback = function()
        pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/memeenjoyer43/darkdex/refs/heads/main/script"))()
        end)
    end
})

----------------------------------------------------
----------------------- ESP ------------------------
----------------------------------------------------
_G.ARK_ESP_ENABLED = false
local ESP_Holder

local function HardKillESP()
    if ESP_Holder then
        ESP_Holder:Destroy()
        ESP_Holder = nil
    end
end

local function StartESP()
    if not ESP_Holder then
        ESP_Holder = Instance.new("Folder", game.CoreGui)
        ESP_Holder.Name = "ESP"
    end

    task.spawn(function()
        while task.wait() and _G.ARK_ESP_ENABLED do
            for _, v in pairs(Players:GetPlayers()) do
                if v ~= LocalPlayer and v.Character then
                    if not v.Character:FindFirstChild("GetReal") then
                        local highlight = Instance.new("Highlight")
                        highlight.Name = "GetReal"
                        highlight.Adornee = v.Character
                        highlight.RobloxLocked = true
                        highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                        highlight.FillColor = (_G.UseTeamColor and v.TeamColor.Color) or ((LocalPlayer.TeamColor == v.TeamColor) and _G.FriendColor or _G.EnemyColor)
                        highlight.Parent = v.Character
                    else
                        v.Character.GetReal.FillColor = (_G.UseTeamColor and v.TeamColor.Color) or ((LocalPlayer.TeamColor == v.TeamColor) and _G.FriendColor or _G.EnemyColor)
                    end
                end
            end
        end
    end)
end

MainTab:CreateToggle({
    Name = "ESP",
    CurrentValue = false,
    SectionParent = MainSection,
    Flag = "ESP_TOGGLE",
    Callback = function(v)
        _G.ARK_ESP_ENABLED = v
        if v then
            _G.FriendColor = Color3.fromRGB(0, 0, 255)
            _G.EnemyColor = Color3.fromRGB(255, 0, 0)
            _G.UseTeamColor = true
            StartESP()
        else
            HardKillESP()
        end
    end
})

----------------------------------------------------
---------------------- GAME TAB --------------------
----------------------------------------------------
local GameTab = Window:CreateTab("GAME", 10180536602)
local GameSection = GameTab:CreateSection("Game Info")

-- Safely get product info
local success, productInfo = pcall(function()
    return MarketplaceService:GetProductInfo(game.PlaceId)
end)
local gameName = (success and productInfo and productInfo.Name) or "Unknown"

GameTab:CreateLabel("Game Name: " .. gameName)
local currentPlayersBox = GameTab:CreateLabel("Players: " .. #Players:GetPlayers() .. "/" .. Players.MaxPlayers)
local localPlayerBox = GameTab:CreateLabel("Local Player: " .. LocalPlayer.Name)
local pingBox = GameTab:CreateLabel("Ping: ERROR WITH CALCULTING.")
local timeSinceStartBox = GameTab:CreateLabel("Time Since Start: UNKNOWN DUE TO ERROR.")

local startTime = tick()

-- Safely find RemoteFunction
local RemoteFunction
pcall(function()
    RemoteFunction = ReplicatedStorage:FindFirstChild("YourRemoteFunction") -- replace if needed
end)

-- Ping calculation
local function GetPing()
    if not RemoteFunction then return 0, 0 end
    local startTick = tick()
    local success, serverTime = pcall(function()
        return RemoteFunction:InvokeServer()
    end)
    if success and serverTime then
        return (serverTime - startTick) * 1000, (tick() - serverTime) * 1000
    else
        return 0, 0
    end
end

-- Update loop
task.spawn(function()
    while true do
        task.wait(1)
        pcall(function()
            currentPlayersBox:SetText("Players: " .. #Players:GetPlayers() .. "/" .. Players.MaxPlayers)
            local sent, receive = GetPing()
            pingBox:SetText(string.format("Ping: Sent %.0fms | Receive %.0fms", sent, receive))
            timeSinceStartBox:SetText("Time Since Start: " .. math.floor(tick() - startTime) .. "s")
        end)
    end
end)

----------------------------------------------------
---------------------- INFO TAB --------------------
----------------------------------------------------
local InfoTab = Window:CreateTab("INFO", 10180536602)
local InfoSection = InfoTab:CreateSection("ARK HUB INFORMATION")
InfoTab:CreateLabel("ARK Hub â€” Made by zxkuhl")
InfoTab:CreateLabel("Version: 2.4")
InfoTab:CreateLabel("UPDATE CATALOG: minor bug fixes and major elements added some bugs still need fixed.")
InfoTab:CreateLabel("DISCORD SERVER: AstraCore.")

InfoTab:CreateButton({
    Name = "Copy Discord Invite",
    SectionParent = InfoSection,
    Callback = function()
        pcall(function()
            setclipboard("https://discord.gg/KPUPp4m9pJ")
            Rayfield:Notify({Title="Copied!", Content="Discord invite copied to clipboard.", Duration=3})
        end)
    end
})

----------------------------------------------------
--------------- LOCAL PLAYER TAB -------------------
----------------------------------------------------
local LocalTab = Window:CreateTab("LOCAL PLAYER", 10180536602)
local LPSection = LocalTab:CreateSection("Player Mods")

LocalTab:CreateSlider({
    Name = "Walk Speed",
    Range = {16, 200},
    Increment = 1,
    CurrentValue = 16,
    SectionParent = LPSection,
    Callback = function(v)
        pcall(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                LocalPlayer.Character.Humanoid.WalkSpeed = v
            end
        end)
    end
})

LocalTab:CreateSlider({
    Name = "Jump Power",
    Range = {50, 300},
    Increment = 1,
    CurrentValue = 50,
    SectionParent = LPSection,
    Callback = function(v)
        pcall(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                LocalPlayer.Character.Humanoid.JumpPower = v
            end
        end)
    end
})

LocalTab:CreateToggle({
    Name = "God Mode",
    CurrentValue = false,
    SectionParent = LPSection,
    Callback = function(v)
        pcall(function()
            local h = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid")
            if h then
                if v then
                    h.MaxHealth = math.huge
                    h.Health = math.huge
                else
                    h.MaxHealth = 100
                    h.Health = 100
                end
            end
        end)
    end
})

LocalTab:CreateButton({
    Name = "Infinite Jump",
    SectionParent = LPSection,
    Callback = function()
        pcall(function()
            loadstring(game:HttpGet("https://obj.wearedevs.net/2/scripts/Infinite%20Jump.lua"))()
        end)
    end
})

LocalTab:CreateButton({
    Name = "Become Invisible",
    SectionParent = LPSection,
    Callback = function()
        pcall(function()
            loadstring(game:HttpGet('https://pastebin.com/raw/3Rnd9rHf'))()
        end)
    end
})

----------------------------------------------------
------------------ TOOLS TAB -----------------------
----------------------------------------------------
local ToolsTab = Window:CreateTab("TOOLS", 10180536602)
local ToolsSection = ToolsTab:CreateSection("Utilities")

ToolsTab:CreateButton({
    Name = "Server Hop",
    SectionParent = ToolsSection,
    Callback = function()
        pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/LeoKholYt/roblox/main/lk_serverhop.lua"))():Teleport(game.PlaceId)
        end)
    end
})

ToolsTab:CreateButton({
    Name = "Anti AFK",
    SectionParent = ToolsSection,
    Callback = function()
        pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/evxncodes/mainroblox/main/anti-afk"))()
        end)
    end
})

ToolsTab:CreateButton({
    Name = "Player Info (Console)",
    SectionParent = ToolsSection,
    Callback = function()
        pcall(function()
            print("----- PLAYER INFO START -----")
            for _, v in pairs(Players:GetPlayers()) do
                print("DisplayName:", v.DisplayName)
                print("Username:", v.Name)
                if v.Character and v.Character:FindFirstChild("Humanoid") then
                    print("Health:", v.Character.Humanoid.Health)
                    print("WalkSpeed:", v.Character.Humanoid.WalkSpeed)
                    print("JumpPower:", v.Character.Humanoid.JumpPower)
                else
                    print("Character data unavailable")
                end
                print("UserId:", v.UserId)
                print("Account Age:", v.AccountAge)
                print("----------------------------------------")
                task.wait(0.5)
            end
            print("----- PLAYER INFO END -----")
        end)
    end
})

ToolsTab:CreateButton({
    Name = "Open Teleport Menu",
    SectionParent = ToolsSection,
    Callback = function()
        pcall(function()
            loadstring(game:HttpGet("https://pastebin.com/raw/YourTeleportGUIScript"))()
        end)
    end
})

ToolsTab:CreateButton({
    Name = "Rejoin Server",
    SectionParent = ToolsSection,
    Callback = function()
        pcall(function()
            local ts = game:GetService("TeleportService")
            ts:TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer)
        end)
    end
})

----------------------------------------------------
------------------ VISUALS TAB ---------------------
----------------------------------------------------
local VisualsTab = Window:CreateTab("VISUALS", 10180536602)
local VisualsSection = VisualsTab:CreateSection("Visual Mods")

VisualsTab:CreateToggle({
    Name = "Highlights",
    CurrentValue = false,
    SectionParent = VisualsSection,
    Callback = function(v)
        pcall(function()
            for _, target in pairs(Players:GetPlayers()) do
                if target ~= LocalPlayer and target.Character then
                    local h = target.Character:FindFirstChild("Highlight")
                    if v and not h then
                        h = Instance.new("Highlight")
                        h.Name = "Highlight"
                        h.Adornee = target.Character
                        h.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                        h.FillColor = Color3.fromRGB(255, 0, 0)
                        h.Parent = target.Character
                    elseif not v and h then
                        h:Destroy()
                    end
                end
            end
        end)
    end
})

VisualsTab:CreateToggle({
    Name = "Full Bright",
    CurrentValue = false,
    SectionParent = VisualsSection,
    Callback = function(v)
        pcall(function()
            if v then
                Lighting.Ambient = Color3.new(1, 1, 1)
                Lighting.Brightness = 2
                Lighting.GlobalShadows = false
            else
                Lighting.Ambient = Color3.fromRGB(128, 128, 128)
                Lighting.Brightness = 1
                Lighting.GlobalShadows = true
            end
        end)
    end
})

VisualsTab:CreateToggle({
    Name = "Remove Fog",
    CurrentValue = false,
    SectionParent = VisualsSection,
    Callback = function(v)
        pcall(function()
            if v then
                Lighting.FogEnd = 999999
                Lighting.FogStart = 0
            else
                Lighting.FogEnd = 1000
                Lighting.FogStart = 0
            end
        end)
    end
})
